<!doctype html>
<html lang="vi">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Blockchain Tài chính cá nhân</title>
    <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <!-- Bootstrap CSS (stable CDN). crossorigin helps some CSP setups. -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" crossorigin="anonymous">
    <!-- Minimal fallback styles if CDN is blocked -->
    <style>
      /* Basic layout fallback so page remains usable if CDN is blocked */
      body { font-family: system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; background:#f8f9fa; margin:0 }
      .navbar { background:#343a40; color:#fff; padding:.5rem 1rem }
      .navbar a { color: #fff; text-decoration: none; font-weight:600 }
      .container { max-width: 960px; margin: 1rem auto; padding: 0 1rem }
      .card { background:#fff; border:1px solid #e5e5e5; border-radius:.375rem; margin-bottom:1rem; padding:1rem }
      .btn { display:inline-block; padding:.45rem .75rem; border-radius:.375rem; border:1px solid rgba(0,0,0,.1); background:transparent }
    </style>
  </head>
  <body class="bg-light">
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <div class="container">
        <a class="navbar-brand" href="{{ url_for('index') }}">FinanceChain</a>
        <div>
          <a class="btn btn-outline-light me-2" href="{{ url_for('add') }}">+ Thêm giao dịch</a>
          <a class="btn btn-outline-light" href="{{ url_for('history') }}">Lịch sử</a>
        </div>
      </div>
    </nav>
    <div class="container py-4">
      {% with messages = get_flashed_messages() %}
        {% if messages %}
          <div class="alert alert-info">{{ messages[0] }}</div>
        {% endif %}
      {% endwith %}
      {% block content %}{% endblock %}
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    <!-- Removed Ethers.js to avoid CSP 'eval' warning. We will load it only on pages that need it, with a local file or safer config. -->
    <script>
      async function connectWallet() {
        if (!window.ethereum) { alert('Không tìm thấy MetaMask'); return; }
        try {
          const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
          const account = accounts[0];
          document.getElementById('walletAddr').textContent = account;
        } catch (e) {
          console.error(e);
        }
      }
    </script>
  </body>
</html>
